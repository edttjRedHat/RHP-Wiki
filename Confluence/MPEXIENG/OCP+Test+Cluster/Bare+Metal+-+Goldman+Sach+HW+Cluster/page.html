<p>OCP Test Cluster on Bare Metal with Goldman Sach HW configuration.</p><ac:structured-macro ac:name="panel" ac:schema-version="1" ac:macro-id="45d93f63-2780-48ad-afd4-01048ce96f8e"><ac:parameter ac:name="borderWidth">0</ac:parameter><ac:parameter ac:name="borderStyle">none</ac:parameter><ac:rich-text-body><p><ac:structured-macro ac:name="toc" ac:schema-version="1" ac:macro-id="67e107a6-e747-4181-b931-e299202c302b"><ac:parameter ac:name="outline">true</ac:parameter></ac:structured-macro><ac:structured-macro ac:name="multiexcerpt-include" ac:schema-version="1" ac:macro-id="7c6da25c-b7f8-4b60-9944-81984c186f61"><ac:parameter ac:name="MultiExcerptName">Include--Global</ac:parameter><ac:parameter ac:name="DisableCaching">true</ac:parameter><ac:parameter ac:name="PageWithExcerpt"><ac:link><ri:page ri:content-title="MPEX Integrity Engineering" /></ac:link></ac:parameter><ac:parameter ac:name="shouldDisplayInlineCommentsInIncludes">false</ac:parameter></ac:structured-macro></p></ac:rich-text-body></ac:structured-macro><h1>Infrastructure</h1><p>The <a href="https://docs.google.com/spreadsheets/d/1WjvN3FdfMdcLsdXcrJ4ZLkfNGY9zpLjdHOHnI8K4nMM/edit?gid=0#gid=0">Bare Metal HWs</a> are hosted in RDU 2 lab.</p><h1>OCP Cluster</h1><h2>Current Information</h2><p>Information on the installed OCP Cluster can be retrieved from BitWarden Note.</p><ac:structured-macro ac:name="panel" ac:schema-version="1" ac:macro-id="0ba6a63d-4ee8-4968-a518-034ac9153c90"><ac:parameter ac:name="borderColor">black</ac:parameter><ac:parameter ac:name="borderStyle">solid</ac:parameter><ac:parameter ac:name="title">OCP Cluster Information</ac:parameter><ac:rich-text-body><ac:structured-macro ac:name="html" ac:schema-version="1" ac:macro-id="408b832f-0c14-42f3-92e3-3f4639e544ed"><ac:plain-text-body><![CDATA[<div style="font-family:monospace;font-size:large;line-height:normal;overflow:auto;white-space:nowrap;">
    <div style="float:left;min-width:100%;" tabindex="0">
<pre style="font-size:medium;">
(
    bwNoteName='note.HWcluster--GoldmanSach'
    export BW_SESSION="$((bw status | grep -q '"status":"unlocked"') &amp;&amp; echo "${BW_SESSION}" || bw unlock --raw || bw login --raw)"
    [ -n "${BW_SESSION}" ] &amp;&amp; bw sync || {
        echo 'You do NOT have an active and sync:ed BitWarden Session!!!' 1&gt;&amp;2
        exit 1
    }
    bwData="$(bw get item "${bwNoteName}")" || {
        echo "You may NOT have access to BitWarden Note \`${bwNoteName}\`." 1&gt;&amp;2
        exit 1
    }
    tput smcup
    i=4 t=10
    while ((i--)); do
        clear
        case $i in
          (3)
            echo 'General Information.'
            echo "${bwData}" | jq -r '.notes'
            ;;
          (2)
            echo 'Accessing BMCs.'
            echo "${bwData}" | jq -r '.fields[] | select(.name == "BMC").value'
            ;;
          (1)
            echo 'Serial Console Credential.'
            echo "${bwData}" | jq -r '.fields[] | select(.name == "SerialConsole").value'
            ;;
          (0)
            echo 'Accessing Nodes.'
            echo "${bwData}" | jq -r '.fields[] | select(.name == "NodeAccess").value'
            ;;
        esac
        REPLY=' ' j=t
        tput civis
        while ((j)); do
            tput cr; tput el
            printf "Press [SPACE] key to stay on this page (timeout in $((j--)) sec.) or any OTHER key to continue now..."
            read -srn 1 -t 1 || continue
            [ "${REPLY}" = ' ' ] &amp;&amp; j=t || break
        done
        tput cnorm
    done
    tput rmcup
)

</pre>
    </div>
</div>]]></ac:plain-text-body></ac:structured-macro></ac:rich-text-body></ac:structured-macro><h2>Current KUBECONFIG</h2><p>The KUBECONFIG file can be downloaded from BitWarden Note.</p><ac:structured-macro ac:name="panel" ac:schema-version="1" ac:macro-id="9aa5200e-d42e-40ca-bb10-47d55b1c0780"><ac:parameter ac:name="borderColor">black</ac:parameter><ac:parameter ac:name="borderStyle">solid</ac:parameter><ac:parameter ac:name="title">OCP Cluster KUBECONFIG</ac:parameter><ac:rich-text-body><ac:structured-macro ac:name="html" ac:schema-version="1" ac:macro-id="773f3bf0-7be8-4b66-8e38-923abdc96543"><ac:plain-text-body><![CDATA[<div style="font-family:monospace;font-size:large;line-height:normal;overflow:auto;white-space:nowrap;">
    <div style="float:left;min-width:100%;" tabindex="0">
<pre style="font-size:medium;">
(
    bwNoteName='note.HWcluster--GoldmanSach'
    export BW_SESSION="$((bw status | grep -q '"status":"unlocked"') &amp;&amp; echo "${BW_SESSION}" || bw unlock --raw || bw login --raw)"
    [ -n "${BW_SESSION}" ] &amp;&amp; bw sync || {
        echo 'You do NOT have an active and sync:ed BitWarden Session!!!' 1&gt;&amp;2
        exit 1
    }
    bw get --itemid "${bwNoteName}" attachment "$(
        bw get item "${bwNoteName}" |
        jq -r '(.attachments // [])[] | select(.fileName == "kubeconfig") | .id'
    )" || {
        echo "You may NOT have access to BitWarden Note \`${bwNoteName}\`." 1&gt;&amp;2
        exit 1
    }
)

</pre>
    </div>
</div>]]></ac:plain-text-body></ac:structured-macro></ac:rich-text-body></ac:structured-macro><h2>Updating KUBECONFIG</h2><ac:structured-macro ac:name="panel" ac:schema-version="1" ac:macro-id="a0039faf-eb52-4902-89c0-4f8c93c4a6c1"><ac:parameter ac:name="borderColor">black</ac:parameter><ac:parameter ac:name="borderStyle">solid</ac:parameter><ac:parameter ac:name="title">OCP Cluster KUBECONFIG</ac:parameter><ac:rich-text-body><ac:structured-macro ac:name="html" ac:schema-version="1" ac:macro-id="099fd4e7-d7d4-4916-8542-8e133dbce2d6"><ac:plain-text-body><![CDATA[<div style="font-family:monospace;font-size:large;line-height:normal;overflow:auto;white-space:nowrap;">
    <div style="float:left;min-width:100%;" tabindex="0">
<pre style="font-size:medium;">
(
    bwAttFilePath='<span style="color:red;font-weight:bold;">...pathToKubeConfigFile...</span>'
    bwNoteName='note.HWcluster--GoldmanSach'
    set -o pipefail
    export BW_SESSION="$((bw status | grep -q '"status":"unlocked"') &amp;&amp; echo "${BW_SESSION}" || bw unlock --raw || bw login --raw)"
    [ -n "${BW_SESSION}" ] &amp;&amp; bw sync || {
        echo 'You do NOT have an active and sync:ed BitWarden Session!!!' 1&gt;&amp;2
        exit 1
    }
    bwItemID="$(bw get item "${bwNoteName}" | jq -r '.id')" || {
        echo "You may NOT have access to BitWarden Note \`${bwNoteName}\`." 1&gt;&amp;2
        exit 1
    }
    while IFS='' read -r e; do
        bw delete --itemid "${bwItemID}" attachment "${e}" || {
            echo "You do NOT have R/W access to BitWarden Note \`${_BW__NOTE_NAME}\`." 1&gt;&amp;2
            exit 1
        }
    done 0&lt; &lt;(
        bw get item "${bwNoteName}" |
        jq -r '(.attachments // [])[] | select(.fileName == "kubeconfig") | .id'
    )
    bw create --file "${bwAttFilePath}" --itemid "${bwItemID}" attachment 1&gt; /dev/null
)

</pre>
    </div>
</div>]]></ac:plain-text-body></ac:structured-macro></ac:rich-text-body></ac:structured-macro><p><br /></p>
